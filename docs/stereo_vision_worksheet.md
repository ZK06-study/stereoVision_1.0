# 스테레오비전 학습지

**학습자명**: _________________ **날짜**: _________________

---

## 📋 학습 목표
이 학습지를 통해 다음을 습득합니다:
- 스테레오비전의 기본 개념과 원리 이해
- 3차원 거리 계산 수식 유도 및 적용
- 다양한 Stereo Matching 알고리즘의 특징 파악
- Python 코드를 통한 실습 경험

---

## 1️⃣ 기본 개념 정리

### 1.1 스테레오비전 개념 설명

**문제 1**: 다음 빈 칸을 채우세요.

스테레오비전은 인간의 ______와 동일한 원리로, 두 개의 ______를 이용하여 동일한 장면을 서로 다른 위치에서 촬영한 후, 좌우 영상 간의 ______(시차) 정보를 분석하여 _______ 공간 정보를 획득하는 기술입니다.

**답안**: 
- ① ________________
- ② ________________ 
- ③ ________________
- ④ ________________

---

### 1.2 장단점 비교

**문제 2**: 스테레오비전의 장단점을 정리해보세요.

| 장점 | 단점 |
|------|------|
| ① | ① |
| ② | ② |
| ③ | ③ |
| ④ | ④ |

---

## 2️⃣ 수학적 원리 학습

### 2.1 매개변수 정의

**문제 3**: 다음 매개변수들의 의미를 설명하세요.

- **b (Baseline)**: ________________________________
- **f (Focal Length)**: ____________________________
- **d (Disparity)**: _______________________________
- **z (Distance)**: ________________________________

### 2.2 수식 유도 연습

**문제 4**: 스테레오비전 깊이 계산 공식을 단계별로 유도해보세요.

**Step 1**: 좌측 카메라 비례식
$$x_l : f = \left( x + \frac{b}{2} \right) : z$$

이를 방정식으로 변환하면:
$$x_l z = \_\_\_\_\_\_\_\_\_\_\_\_$$

**Step 2**: 우측 카메라 비례식
$$x_r : f = \left( x - \frac{b}{2} \right) : z$$

이를 방정식으로 변환하면:
$$x_r z = \_\_\_\_\_\_\_\_\_\_\_\_$$

**Step 3**: 두 방정식의 차이 계산
$$x_l z - x_r z = \_\_\_\_\_\_\_\_\_\_\_\_$$

**Step 4**: 최종 공식 도출
$$z = \_\_\_\_\_\_\_\_\_\_\_\_$$

### 2.3 수치 계산 연습

**문제 5**: 다음 조건에서 물체까지의 거리를 계산하세요.

**주어진 조건**:
- Baseline (b) = 20cm = 0.2m
- Focal Length (f) = 800 pixels
- 좌측 영상에서 물체의 x 좌표 = 320 pixels
- 우측 영상에서 물체의 x 좌표 = 280 pixels

**계산 과정**:
1. 시차(d) 계산: d = x_l - x_r = _____ - _____ = _____ pixels
2. 거리(z) 계산: z = fb/d = (_____ × _____) / _____ = _____ meters

**답**: 물체까지의 거리는 **_____m** 입니다.

---

## 3️⃣ Stereo Matching 알고리즘

### 3.1 알고리즘 분류

**문제 6**: 다음 표를 완성하세요.

| 구분 | 전역 정합 | 지역 정합 |
|------|-----------|-----------|
| **처리 범위** | | |
| **정확도** | | |
| **계산 복잡도** | | |
| **처리 속도** | | |
| **대표 알고리즘** | | |

### 3.2 지역 정합 방법 상세 학습

**문제 7**: 각 알고리즘의 수식과 특징을 매칭하세요.

**알고리즘**:
A) SAD (Sum of Absolute Differences)
B) SSD (Sum of Squared Differences)  
C) Census Transform

**수식**:
① $\\sum_{i,j} |I_L(i,j) - I_R(i,j)|$
② $\\sum_{i,j} (I_L(i,j) - I_R(i,j))^2$
③ XOR 연산 후 1의 개수 계산

**특징**:  
ⓐ 노이즈에 강함, 조명 변화에 robust
ⓑ 계산이 간단하고 빠름
ⓒ 큰 차이에 더 민감함

**매칭 결과**:
- A - (___) - (___)
- B - (___) - (___)  
- C - (___) - (___)

---

## 4️⃣ Python 코드 실습

### 4.1 코드 빈칸 채우기

**문제 8**: 다음 OpenCV 스테레오비전 코드의 빈칸을 채우세요.

```python
import cv2
import numpy as np
import matplotlib.pyplot as plt

# 스테레오 영상 로드
imgL = cv2.imread('left_image.png', _____)  # ① 그레이스케일로 로드
imgR = cv2.imread('right_image.png', _____)  # ② 그레이스케일로 로드

# StereoBM 객체 생성
stereo = cv2.StereoBM_create(
    numDisparities=_____,  # ③ 시차 범위 (16의 배수)
    blockSize=_____        # ④ 블록 크기 (홀수)
)

# 시차 맵 계산
disparity = stereo._____(imgL, imgR)  # ⑤ compute 메서드

# 결과 시각화
plt.figure(figsize=(12, 4))
plt.subplot(131); plt.imshow(imgL, 'gray'); plt.title('_____')     # ⑥
plt.subplot(132); plt.imshow(imgR, 'gray'); plt.title('_____')     # ⑦  
plt.subplot(133); plt.imshow(disparity, 'plasma'); plt.title('_____') # ⑧
plt.show()
```

**답안**:
- ① ________  ② ________  ③ ________  ④ ________
- ⑤ ________  ⑥ ________  ⑦ ________  ⑧ ________

### 4.2 함수 구현

**문제 9**: 시차 맵을 깊이 맵으로 변환하는 함수를 완성하세요.

```python
def disparity_to_depth(disparity, focal_length, baseline):
    """
    시차 맵을 깊이 맵으로 변환
    공식: z = (f * b) / d
    """
    # 0으로 나누기 방지
    disparity[disparity == 0] = _____  # ① 작은 값으로 대체
    
    # 깊이 계산
    depth = (_____ * _____) / _____    # ② 공식 적용
    
    return depth

# 사용 예시
focal_length = 700  # pixels
baseline = 0.2      # meters
depth_map = disparity_to_depth(disparity, _____, _____)  # ③④ 매개변수
```

**답안**:
- ① ________  ② ________  ③ ________  ④ ________

---

## 5️⃣ 응용 문제

### 5.1 매개변수 영향 분석

**문제 10**: 다음 상황에서 깊이 측정 결과가 어떻게 변할지 예측하고 이유를 설명하세요.

**상황 A**: Baseline을 2배로 늘린 경우
- 결과 예측: ________________________________
- 이유: ____________________________________

**상황 B**: 물체가 카메라에서 2배 멀어진 경우  
- 시차 변화: ________________________________
- 측정 정확도: ______________________________

### 5.2 알고리즘 선택

**문제 11**: 다음 상황에서 가장 적합한 알고리즘을 선택하고 이유를 설명하세요.

**상황 1**: 실시간 처리가 중요한 자율주행 시스템
- 선택: __________________
- 이유: __________________

**상황 2**: 정확도가 중요한 3D 스캐닝 시스템
- 선택: __________________  
- 이유: __________________

**상황 3**: 조명 변화가 심한 야외 환경
- 선택: __________________
- 이유: __________________

---

## 6️⃣ 실습 과제

### 과제 1: 매개변수 실험
다음 매개변수들을 변경해가며 결과를 관찰하고 보고서를 작성하세요.

**실험 조건**:
- numDisparities: 16, 32, 64, 96
- blockSize: 5, 11, 15, 21

**관찰 항목**:
1. 처리 속도 변화
2. 시차 맵 품질 변화  
3. 노이즈 레벨 변화

### 과제 2: 알고리즘 비교
StereoBM과 StereoSGBM의 결과를 비교 분석하세요.

**비교 항목**:
- 처리 시간
- 시차 맵 품질
- 매개변수 민감도

---

## 📝 학습 점검

### 자가 진단 체크리스트

다음 항목들을 스스로 평가해보세요 (5점 만점):

- [ ] 스테레오비전의 기본 원리를 이해했다 (___/5)
- [ ] 깊이 계산 공식을 유도할 수 있다 (___/5)  
- [ ] 다양한 매칭 알고리즘의 특징을 안다 (___/5)
- [ ] Python 코드를 이해하고 수정할 수 있다 (___/5)
- [ ] 매개변수 조정의 영향을 예측할 수 있다 (___/5)

**총점**: ___/25

### 어려웠던 부분
_________________________________________________
_________________________________________________
_________________________________________________

### 더 알고 싶은 내용  
_________________________________________________
_________________________________________________
_________________________________________________

---

## 🎯 다음 단계

이 학습지를 완료한 후:
1. **퀴즈**로 이해도를 점검하세요
2. **실습 프로젝트**에 도전해보세요  
3. **심화 알고리즘** 학습을 고려해보세요

---

**수고하셨습니다!** 🎉

*질문이 있으면 언제든지 물어보세요.*